<script>

function grabJobList(shift_id, with_orgs = true) {
    url = "{{ path('job_index', {'access': 'ajax' }) }}" 
        + "?shift=" + shift_id;
    if (with_orgs == true) {
        url += "&with_orgs=true";
    }
    $.get(url, function( data ) {
        $( "#jobTable_" + shift_id ).html(data);
        $( "#jobList_" + shift_id ).show();
    });
    return false;
}

function hideJobList(shift_id) {
    $( "#jobList_" + shift_id ).hide();
}

function setStateOnJob(job_id, state, shift_id) {
    cheat_url = "{{ path('job_state', { 'id': 0, 'state': 'NONE', 'access': 'ajax' }) }}";
    c_url = cheat_url.replace("0", job_id);
    url = c_url.replace("NONE", state);
    $.ajax({
        beforeSend: function(req) {
          req.setRequestHeader("Accept", "application/json");
        },
        url: url,
        type: "POST",
        async: true,
      }).done( function( cont, textStatus, xhr ) {
            grabJobList(shift_id);
      }).fail(function(xhr, status, error) {
            errmsg = "Message sending failed\n";
            errmsg = errmsg + xhr.responseText + "\n";
            alert(errmsg);
    });
    return false;
}
</script>
