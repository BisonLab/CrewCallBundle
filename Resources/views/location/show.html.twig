{% extends 'base.html.twig' %}

{% block body %}
<div class="col-sm-3">
    <h1>{{ location }}</h1>

    <table class="showTable">
        <tbody>
            <tr>
                <th>Name</th>
                <td>{{ location.name }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ location.description }}</td>
            </tr>
            <tr>
                <th>Phone number</th>
                <td>{{ location.phonenumber }}</td>
            </tr>
            <tr>
                <th>Address</th>
                <td>{{ cc_addressing.compose(location, 'html') | raw }}</td>
            </tr>
        </tbody>
    </table>

    <ul>
        <li>
            <a href="#" id="popLogSummary_location_{{ location.id }}" data-toggle="popover" data-html="true" onClick="popLogSummary('location', {{ location.id }});"><button>Changes</button></a>
        </li>
        <li>
            <a href="{{ path('location_edit', { 'id': location.id }) }}"><button>Edit</button></a>
        </li>
        <li>
            {{ form_start(delete_form) }}
                <input type="submit" value="Delete">
            {{ form_end(delete_form) }}
        </li>
    </ul>
</div>


<div class="col-sm-9" id="eventRight">
  <ul id="tabRight" class="nav nav-tabs">
  <li class="active">
  <a href="#notestab" data-toggle="tab">Notes</a>
  </li>
  <li>
  <a href="#filestab" data-toggle="tab">Files</a>
  </li>
  </ul>

  <div class="tab-content ">
    <div class="tab-pane active" id="notestab">
      {% set mconf = {'mconfig': {
              'formname': 'locationnote',
              'reload_after_post': true,
              'subject': "",
              'to_field': false,
              'from_field': false,
              'message_type': 'AdminNote',
              'context': {
                  'system': 'crewcall',
                  'object_name': 'location',
                  'external_id': location.id
                  }
              }
          }
      %}
      {% include 'BisonLabSakonninBundle:Message:_create_popup.html.twig' with mconf %}
      <p>
      <br>
      <a href="#" onClick='createMessage("locationnote");'>Add a note</a><br />
      </p>
    {% set mlogcontext = {
        'system': 'crewcall',
        'object_name': 'location',
        'message_type': 'Notes',
        'external_id': location.id
        }
    %}
    {% for note in sakonnin_messages.MessagesForContext(mlogcontext) %}
        <strong>{{ note.subject }}</strong><br>
        <pre>{{ note.body }}</pre>
        <br>
    {% endfor %}
  </div>

  <div class="tab-pane" id="filestab">
    {% set sfconf = {'sfconfig': {
            'file_type': "AUTO",
            'context': {
                'system': 'crewcall',
                'object_name': 'location',
                'external_id': location.id
                }
            }
        }
    %}
    {% include 'BisonLabSakonninBundle:SakonninFile:_create_popup.html.twig' with sfconf %}
    <p>
    <br>
      <a href="#" onClick="uploadFile(); return false;">Add a document or image</a><br />
    </p>
    {% set filecontext = {
        'system': 'crewcall',
        'object_name': 'location',
        'external_id': location.id
        }
    %}
    {% include 'CrewCallBundle::_files.html.twig' with filecontext %}
  </div>
 </div>
</div>


{% endblock %}
